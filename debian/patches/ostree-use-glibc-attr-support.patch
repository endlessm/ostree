From 534c4c20c3fa5ad9500ea96093a3ece7821a6056 Mon Sep 17 00:00:00 2001
From: Daniel Svensson <dsvensson@gmail.com>
Date: Wed, 1 Apr 2015 09:45:20 +0200
Subject: build: Use glibc's xattr support instead of requiring libattr

Fixes the build on Debian, and is one library less.

Closes: #78

diff --git a/configure.ac b/configure.ac
index 4042524..e11be41 100644
--- a/configure.ac
+++ b/configure.ac
@@ -39,7 +39,7 @@ AC_ARG_ENABLE(installed_tests,
               [enable_installed_tests=no])
 AM_CONDITIONAL(BUILDOPT_INSTALL_TESTS, test x$enable_installed_tests = xyes)
 
-AC_CHECK_HEADER([attr/xattr.h],,[AC_MSG_ERROR([You must have attr/xattr.h from libattr])])
+AC_CHECK_HEADER([sys/xattr.h],,[AC_MSG_ERROR([You must have sys/xattr.h from glibc])])
 
 PKG_PROG_PKG_CONFIG
 
diff --git a/src/libostree/ostree-repo-checkout.c b/src/libostree/ostree-repo-checkout.c
index daca66e..22aaf56 100644
--- a/src/libostree/ostree-repo-checkout.c
+++ b/src/libostree/ostree-repo-checkout.c
@@ -23,7 +23,7 @@
 #include "config.h"
 
 #include <glib-unix.h>
-#include <attr/xattr.h>
+#include <sys/xattr.h>
 #include <gio/gfiledescriptorbased.h>
 #include <gio/gunixoutputstream.h>
 #include "otutil.h"
diff --git a/src/libostree/ostree-repo-commit.c b/src/libostree/ostree-repo-commit.c
index ce5aa07..6ba606f 100644
--- a/src/libostree/ostree-repo-commit.c
+++ b/src/libostree/ostree-repo-commit.c
@@ -34,7 +34,7 @@
 #include "ostree-checksum-input-stream.h"
 #include "ostree-mutable-tree.h"
 #include "ostree-varint.h"
-#include <attr/xattr.h>
+#include <sys/xattr.h>
 #include <glib/gprintf.h>
 
 gboolean
diff --git a/src/libotutil/ot-fs-utils.c b/src/libotutil/ot-fs-utils.c
index 7137b82..040636b 100644
--- a/src/libotutil/ot-fs-utils.c
+++ b/src/libotutil/ot-fs-utils.c
@@ -22,7 +22,7 @@
 
 #include "ot-fs-utils.h"
 #include "libgsystem.h"
-#include <attr/xattr.h>
+#include <sys/xattr.h>
 #include <gio/gunixinputstream.h>
 
 int
-- 
cgit v0.10.2

